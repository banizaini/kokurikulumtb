<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Dashboard Koku | SMKA Tok Bachok</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

    <style>
        .geo-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; background-color: #0f172a; overflow: hidden;
        }
        .shape {
            position: absolute; filter: blur(70px); opacity: 0.3; animation: move 15s infinite alternate;
        }
        @keyframes move {
            from { transform: translate(0,0) scale(1); }
            to { transform: translate(50px, 100px) scale(1.2); }
        }
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .active-tab {
            border-bottom: 4px solid #34d399;
            background: rgba(52, 211, 153, 0.1);
        }
    </style>
</head>
<body class="text-slate-200">

    <div class="geo-bg">
        <div class="shape bg-blue-600 w-96 h-96 -top-20 -left-20"></div>
        <div class="shape bg-emerald-600 w-80 h-80 bottom-0 right-0"></div>
    </div>

    <div class="container mx-auto px-4 py-10 max-w-6xl">
        <div class="text-center mb-10">
            <h1 class="text-4xl font-black tracking-tighter text-white">SMKA TOK BACHOK</h1>
            <p class="text-emerald-400 font-bold tracking-[0.2em] text-sm">DASHBOARD PENGURUSAN KOKURIKULUM</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
            <div class="glass p-6 rounded-3xl text-center">
                <p class="text-xs text-slate-400 uppercase">Status Sistem</p>
                <p class="text-xl font-bold text-emerald-400">AKTIF / LIVE</p>
            </div>
            <div class="glass p-6 rounded-3xl text-center">
                <p class="text-xs text-slate-400 uppercase">Tahun</p>
                <p class="text-xl font-bold">2024 / 2025</p>
            </div>
            <div class="glass p-6 rounded-3xl text-center">
                <p class="text-xs text-slate-400 uppercase">Kemaskini Terakhir</p>
                <p class="text-xl font-bold" id="last-update">-</p>
            </div>
        </div>

        <div class="flex flex-col md:flex-row gap-4 mb-8">
            <button onclick="muatData('uniform')" id="btn-uniform" class="flex-1 glass p-5 rounded-2xl font-bold hover:scale-105 transition-all duration-300">
                <i class="fas fa-shield-alt mb-2 text-blue-400 block"></i> BADAN BERUNIFORM
            </button>
            <button onclick="muatData('kelab')" id="btn-kelab" class="flex-1 glass p-5 rounded-2xl font-bold hover:scale-105 transition-all duration-300">
                <i class="fas fa-users mb-2 text-emerald-400 block"></i> KELAB & PERSATUAN
            </button>
            <button onclick="muatData('sukan')" id="btn-sukan" class="flex-1 glass p-5 rounded-2xl font-bold hover:scale-105 transition-all duration-300">
                <i class="fas fa-running mb-2 text-purple-400 block"></i> SUKAN & PERMAINAN
            </button>
        </div>

        <div class="glass rounded-3xl overflow-hidden min-h-[500px]">
            <div id="loading" class="hidden p-20 text-center">
                <i class="fas fa-circle-notch fa-spin text-4xl text-emerald-400 mb-4"></i>
                <p>Menyinkron data dari Google Sheets...</p>
            </div>
            
            <div id="data-display" class="p-6 md:p-10">
                <div class="text-center py-20 opacity-50">
                    <i class="fas fa-arrow-up text-5xl mb-4"></i>
                    <p class="text-xl">Sila pilih unit untuk paparan senarai ahli</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // MASUKKAN LINK CSV ANDA DI SINI
        const csvLinks = {
            uniform: 'LINK_CSV_TAB_UNIFORM',
            kelab: 'LINK_CSV_TAB_KELAB',
            sukan: 'LINK_CSV_TAB_SUKAN'
        };

        async function muatData(unit) {
            const display = document.getElementById('data-display');
            const loading = document.getElementById('loading');
            
            // Set butang aktif
            document.querySelectorAll('button').forEach(b => b.classList.remove('active-tab'));
            document.getElementById('btn-' + unit).classList.add('active-tab');

            display.classList.add('hidden');
            loading.classList.remove('hidden');

            // Gunakan PapaParse untuk tarik data
            Papa.parse(csvLinks[unit], {
                download: true,
                header: true,
                complete: function(results) {
                    const data = results.data;
                    let tableHTML = `
                        <div class="mb-6 flex justify-between items-end">
                            <h2 class="text-3xl font-black uppercase">${unit.replace('_', ' ')}</h2>
                            <p class="text-emerald-400 font-bold">JUMLAH: ${data.length} AHLI</p>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="border-b border-slate-700 text-slate-400">
                                    <tr>
                                        <th class="py-4 px-2">BIL</th>
                                        <th class="py-4 px-2">NAMA MURID</th>
                                        <th class="py-4 px-2 text-center">KELAS</th>
                                        <th class="py-4 px-2">NAMA UNIT</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-slate-800">
                    `;

                    data.forEach((row, index) => {
                        // Pastikan nama kolum (NAMA, KELAS, UNIT) sama dengan dalam Google Sheet anda
                        if(row.NAMA) { 
                            tableHTML += `
                                <tr class="hover:bg-white/5 transition">
                                    <td class="py-4 px-2 text-slate-500 text-sm">${index + 1}</td>
                                    <td class="py-4 px-2 font-semibold text-white">${row.NAMA}</td>
                                    <td class="py-4 px-2 text-center">${row.KELAS}</td>
                                    <td class="py-4 px-2 text-emerald-400 text-sm">${row.UNIT}</td>
                                </tr>
                            `;
                        }
                    });

                    tableHTML += `</tbody></table></div>`;
                    display.innerHTML = tableHTML;
                    
                    loading.classList.add('hidden');
                    display.classList.remove('hidden');
                    document.getElementById('last-update').innerText = new Date().toLocaleTimeString();
                },
                error: function() {
                    display.innerHTML = "<p class='text-center text-red-400 p-10'>Ralat: Sila pastikan link CSV betul dan Google Sheet telah di-Publish.</p>";
                    loading.classList.add('hidden');
                    display.classList.remove('hidden');
                }
            });
        }
    </script>
</body>
</html>
